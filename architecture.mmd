graph TB
    subgraph "ğŸ¯ Career Break Resilience System"
        User[ğŸ‘¤ Career Returner<br/>User Input]
        
        subgraph "ğŸ§  MCP Server - Custom Tools Layer"
            JD[ğŸ“‹ Job Description<br/>Parser Tool]
            Market[ğŸ“Š Market Intelligence<br/>Tool]
            ATS[ğŸ¤– ATS Scanner<br/>Tool]
            Skills[ğŸ¯ Skill Gap<br/>Analyzer Tool]
            Learning[ğŸ“š Learning Path<br/>Generator Tool]
            Resume[ğŸ“„ Resume Optimizer<br/>Tool]
        end
        
        subgraph "ğŸ­ Claude MCP Client - Orchestration Layer"
            Agent[ğŸª Multi-Agent<br/>Orchestrator]
            Memory[ğŸ§  Conversation<br/>Memory]
            Router[ğŸ”€ Workflow<br/>Router]
        end
        
        subgraph "ğŸ’¾ Knowledge & Data Layer"
            VectorDB[(ğŸ—„ï¸ Vector Database<br/>Job Market Knowledge)]
            GraphDB[(ğŸ•¸ï¸ Graph Database<br/>Skills Relationships)]
            Cache[(âš¡ Redis Cache<br/>Prompt/Response)]
        end
        
        subgraph "ğŸ”§ RAG Pipeline"
            Embed[ğŸ”¤ Embeddings<br/>text-embedding-3]
            Retrieve[ğŸ” Semantic<br/>Retrieval]
            Rerank[â­ Re-ranking<br/>Cohere/Cross-encoder]
        end
        
        subgraph "ğŸ“¤ Output Generation"
            Report[ğŸ“Š Analysis Report]
            Plan[ğŸ“‹ Learning Plan]
            OptResume[âœ… Optimized Resume]
        end
    end
    
    %% User Flow
    User -->|Job Description +<br/>Current Resume| Agent
    
    %% Agent orchestrates tools via MCP
    Agent -->|Segment 1:<br/>Parse JD| JD
    Agent -->|Segment 2:<br/>Market Analysis| Market
    Agent -->|Segment 3:<br/>ATS Check| ATS
    Agent -->|Segment 4:<br/>Gap Analysis| Skills
    Agent -->|Segment 5:<br/>Learning Path| Learning
    Agent -->|Segment 6:<br/>Resume Tailor| Resume
    
    %% Tools interact with data layer
    JD --> Embed
    Market --> VectorDB
    ATS --> Cache
    Skills --> GraphDB
    Learning --> VectorDB
    Resume --> Cache
    
    %% RAG Pipeline
    Embed --> VectorDB
    VectorDB --> Retrieve
    Retrieve --> Rerank
    Rerank --> Agent
    
    %% Memory management
    Agent --> Memory
    Memory --> Router
    Router --> Agent
    
    %% Output generation
    Agent --> Report
    Agent --> Plan
    Agent --> OptResume
    
    Report --> User
    Plan --> User
    OptResume --> User
    
    %% Styling
    classDef userStyle fill:#e1f5ff,stroke:#0066cc,stroke-width:3px
    classDef mcpStyle fill:#fff4e6,stroke:#ff9800,stroke-width:2px
    classDef claudeStyle fill:#f3e5f5,stroke:#9c27b0,stroke-width:2px
    classDef dataStyle fill:#e8f5e9,stroke:#4caf50,stroke-width:2px
    classDef ragStyle fill:#fce4ec,stroke:#e91e63,stroke-width:2px
    classDef outputStyle fill:#e0f2f1,stroke:#009688,stroke-width:2px
    
    class User userStyle
    class JD,Market,ATS,Skills,Learning,Resume mcpStyle
    class Agent,Memory,Router claudeStyle
    class VectorDB,GraphDB,Cache dataStyle
    class Embed,Retrieve,Rerank ragStyle
    class Report,Plan,OptResume outputStyle
